Investigue los distintos tipos de estado que puede tener una conexión TCP
![[DTE TCP.png]]
- **CLOSED:** No hay conexión activa ni pendiente. Es el estado inicial y final.
- **LISTEN:** Un servidor está esperando activamente las solicitudes de conexión entrantes de los clientes (ha realizado una "apertura pasiva").
- **SYN_SENT:** Un cliente ha enviado un segmento SYN para iniciar una conexión y está esperando una respuesta SYN-ACK del servidor (ha realizado una "apertura activa").
- **SYN_RCVD:** Un servidor ha recibido un SYN de un cliente y ha respondido con un SYN-ACK, y ahora está esperando un ACK final del cliente para completar el establecimiento de la conexión.
- **ESTABLISHED:** La conexión TCP está completamente establecida y ambas partes pueden enviar y recibir datos. Este es el estado normal de transferencia de datos.
- **FIN_WAIT_1:** Una de las partes (cliente o servidor) ha decidido cerrar su lado de la conexión y ha enviado un segmento FIN al otro extremo, esperando un ACK o un FIN.
- **FIN_WAIT_2:** El lado que envió el FIN ha recibido el ACK del otro extremo y ahora solo está esperando que el otro lado envíe su propio FIN para cerrar su sentido de la conexión.
- **CLOSE_WAIT:** Un lado de la conexión ha recibido un FIN del otro extremo y lo ha reconocido con un ACK. Ahora está esperando que su propia aplicación local decida cerrar su sentido de la conexión y envíe su propio FIN.
- **LAST_ACK:** El lado que estaba en CLOSE_WAIT ha enviado su propio FIN y ahora está esperando el ACK final del otro extremo para cerrar completamente la conexión.
- **CLOSING:** Un estado raro que ocurre cuando ambos extremos intentan cerrar la conexión simultáneamente (ambos envían FIN al mismo tiempo). Se está esperando el ACK para el FIN que se envió.
- **TIME_WAIT:** El estado final de espera. La parte que inició el cierre activo y envió el ACK final al FIN del otro extremo entra en este estado. Permanece aquí durante un tiempo determinado (normalmente 2 veces el MSL - Maximum Segment Lifetime) para asegurarse de que todos los paquetes retrasados en la red han muerto y de que el último ACK enviado ha sido recibido por el otro lado. Esto evita que segmentos de una conexión anterior interfieran con una nueva conexión si se reutilizan los mismos números de puerto.